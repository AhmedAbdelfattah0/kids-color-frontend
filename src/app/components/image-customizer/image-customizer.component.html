<div class="bg-white rounded-2xl shadow-sm p-5 mt-4">
  <h3 class="text-sm font-bold text-gray-700 mb-4">‚úèÔ∏è Personalize This Page</h3>

  <!-- Text Input -->
  <div class="mb-4">
    <label class="text-xs font-semibold text-gray-500 block mb-1">
      Child's Name or Message
      <span class="font-normal text-gray-400">({{ text().length }}/40)</span>
    </label>
    <input
      type="text"
      [value]="text()"
      (input)="onTextInput($any($event.target).value)"
      placeholder="e.g. Emma's Coloring Page"
      maxlength="40"
      class="w-full px-3 py-2 border border-gray-200 rounded-xl text-sm focus:outline-none focus:border-[#FF6B35] transition-colors" />
  </div>

  <!-- Position -->
  <div class="mb-4">
    <label class="text-xs font-semibold text-gray-500 block mb-2">Text Position</label>
    <div class="grid grid-cols-2 gap-2">
      <button
        *ngFor="let p of positions"
        (click)="setPosition(p.value)"
        [class]="position() === p.value
          ? 'px-3 py-2 rounded-xl text-xs font-semibold bg-[#FF6B35] text-white transition-colors'
          : 'px-3 py-2 rounded-xl text-xs font-semibold bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors'">
        {{ p.label }}
      </button>
    </div>
  </div>

  <!-- Font Color -->
  <div class="mb-4">
    <label class="text-xs font-semibold text-gray-500 block mb-2">Font Color</label>
    <div class="flex gap-2">
      <button
        *ngFor="let c of colorOptions"
        (click)="setColor(c.value)"
        [title]="c.label"
        [style.background-color]="c.value"
        [class]="fontColor() === c.value
          ? 'w-8 h-8 rounded-full border-2 border-[#FF6B35] ring-2 ring-[#FF6B35] ring-offset-1 transition-all'
          : 'w-8 h-8 rounded-full border-2 border-white shadow hover:scale-110 transition-all outline outline-1 outline-gray-200'">
      </button>
    </div>
  </div>

  <!-- Font Size -->
  <div class="mb-5">
    <label class="text-xs font-semibold text-gray-500 block mb-1">
      Font Size: {{ fontSize() }}px
    </label>
    <input
      type="range"
      min="20"
      max="72"
      [value]="fontSize()"
      (input)="onFontSizeChange($any($event.target).value)"
      class="w-full accent-[#FF6B35]" />
    <div class="flex justify-between text-xs text-gray-400 mt-1">
      <span>20px</span>
      <span>72px</span>
    </div>
  </div>

  <!-- Canvas Preview -->
  <div class="mb-4">
    <label class="text-xs font-semibold text-gray-500 block mb-2">Live Preview</label>
    <div class="relative rounded-xl overflow-hidden bg-gray-50 border border-gray-100 flex items-center justify-center min-h-[200px]">
      <div *ngIf="isLoading()" class="absolute inset-0 flex items-center justify-center">
        <span class="text-2xl animate-spin">üñçÔ∏è</span>
      </div>
      <canvas
        #previewCanvas
        class="w-full rounded-xl"
        [class.opacity-0]="isLoading()">
      </canvas>
    </div>
  </div>

  <!-- Download Button -->
  <button
    (click)="downloadCustomized()"
    [disabled]="isLoading() || downloading()"
    class="w-full bg-[#4ECDC4] hover:bg-teal-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-2xl transition-all flex items-center justify-center gap-2">
    {{ downloading() ? '‚è≥ Downloading...' : '‚¨áÔ∏è Download Customized PNG' }}
  </button>
</div>
